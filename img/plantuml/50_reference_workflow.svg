<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="840px" preserveAspectRatio="none" style="width:1352px;height:840px;" version="1.1" viewBox="0 0 1352 840" width="1352px" zoomAndPan="magnify"><defs><filter height="300%" id="fjo1uvfx9bzla" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="435" x="459.75" y="26.708">Argos Server oauth2 authorization flow for azure</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="69" x2="69" y1="121.25" y2="753.0391"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="327.5" x2="327.5" y1="121.25" y2="753.0391"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="554.5" x2="554.5" y1="121.25" y2="753.0391"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="730.5" x2="730.5" y1="121.25" y2="753.0391"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1058.5" x2="1058.5" y1="121.25" y2="753.0391"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1311.5" x2="1311.5" y1="121.25" y2="753.0391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="117" x="8" y="117.9482">personalAccount</text><ellipse cx="69.5" cy="47.9531" fill="#FEFECE" filter="url(#fjo1uvfx9bzla)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M69.5,55.9531 L69.5,82.9531 M56.5,63.9531 L82.5,63.9531 M69.5,82.9531 L56.5,97.9531 M69.5,82.9531 L82.5,97.9531 " fill="none" filter="url(#fjo1uvfx9bzla)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="117" x="8" y="765.0342">personalAccount</text><ellipse cx="69.5" cy="778.3359" fill="#FEFECE" filter="url(#fjo1uvfx9bzla)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M69.5,786.3359 L69.5,813.3359 M56.5,794.3359 L82.5,794.3359 M69.5,813.3359 L56.5,828.3359 M69.5,813.3359 L82.5,828.3359 " fill="none" filter="url(#fjo1uvfx9bzla)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fjo1uvfx9bzla)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="70" x="290.5" y="85.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="297.5" y="105.9482">browser</text><rect fill="#FEFECE" filter="url(#fjo1uvfx9bzla)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="70" x="290.5" y="752.0391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="297.5" y="772.0342">browser</text><rect fill="#FEFECE" filter="url(#fjo1uvfx9bzla)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="499.5" y="85.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="506.5" y="105.9482">argos service</text><rect fill="#FEFECE" filter="url(#fjo1uvfx9bzla)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="499.5" y="752.0391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="506.5" y="772.0342">argos service</text><rect fill="#FEFECE" filter="url(#fjo1uvfx9bzla)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="216" x="620.5" y="85.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="202" x="627.5" y="105.9482">external authorization service</text><rect fill="#FEFECE" filter="url(#fjo1uvfx9bzla)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="216" x="620.5" y="752.0391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="202" x="627.5" y="772.0342">external authorization service</text><rect fill="#FEFECE" filter="url(#fjo1uvfx9bzla)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="412" x="850.5" y="85.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="398" x="857.5" y="105.9482">personalAccount profile service (external resource server)</text><rect fill="#FEFECE" filter="url(#fjo1uvfx9bzla)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="412" x="850.5" y="752.0391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="398" x="857.5" y="772.0342">personalAccount profile service (external resource server)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="64" x="1276.5" y="117.9482">database</text><path d="M1293.5,68.9531 C1293.5,58.9531 1311.5,58.9531 1311.5,58.9531 C1311.5,58.9531 1329.5,58.9531 1329.5,68.9531 L1329.5,94.9531 C1329.5,104.9531 1311.5,104.9531 1311.5,104.9531 C1311.5,104.9531 1293.5,104.9531 1293.5,94.9531 L1293.5,68.9531 " fill="#FEFECE" filter="url(#fjo1uvfx9bzla)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1293.5,68.9531 C1293.5,78.9531 1311.5,78.9531 1311.5,78.9531 C1311.5,78.9531 1329.5,78.9531 1329.5,68.9531 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="64" x="1276.5" y="765.0342">database</text><path d="M1293.5,778.3359 C1293.5,768.3359 1311.5,768.3359 1311.5,768.3359 C1311.5,768.3359 1329.5,768.3359 1329.5,778.3359 L1329.5,804.3359 C1329.5,814.3359 1311.5,814.3359 1311.5,814.3359 C1311.5,814.3359 1293.5,814.3359 1293.5,804.3359 L1293.5,778.3359 " fill="#FEFECE" filter="url(#fjo1uvfx9bzla)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1293.5,778.3359 C1293.5,788.3359 1311.5,788.3359 1311.5,788.3359 C1311.5,788.3359 1329.5,788.3359 1329.5,778.3359 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><polygon fill="#A80036" points="315.5,148.3828,325.5,152.3828,315.5,156.3828,319.5,152.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="69.5" x2="321.5" y1="152.3828" y2="152.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="76.5" y="147.3169">signup / signin</text><polygon fill="#A80036" points="542.5,177.5156,552.5,181.5156,542.5,185.5156,546.5,181.5156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="327.5" x2="548.5" y1="181.5156" y2="181.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="334.5" y="176.4497">get oauth2/authorize/azure</text><polygon fill="#A80036" points="338.5,206.6484,328.5,210.6484,338.5,214.6484,334.5,210.6484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="332.5" x2="553.5" y1="210.6484" y2="210.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="203" x="344.5" y="205.5825">redirect to authorization service</text><polygon fill="#A80036" points="718.5,235.7813,728.5,239.7813,718.5,243.7813,722.5,239.7813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="327.5" x2="724.5" y1="239.7813" y2="239.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="334.5" y="234.7153">get /oauth2/v2.0/authorize</text><polygon fill="#A80036" points="338.5,264.9141,328.5,268.9141,338.5,272.9141,334.5,268.9141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="332.5" x2="729.5" y1="268.9141" y2="268.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="344.5" y="263.8481">login page</text><polygon fill="#A80036" points="80.5,294.0469,70.5,298.0469,80.5,302.0469,76.5,298.0469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="74.5" x2="326.5" y1="298.0469" y2="298.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="86.5" y="292.981">show login page</text><polygon fill="#A80036" points="315.5,323.1797,325.5,327.1797,315.5,331.1797,319.5,327.1797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="69.5" x2="321.5" y1="327.1797" y2="327.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="76.5" y="322.1138">enter credentials</text><polygon fill="#A80036" points="718.5,352.3125,728.5,356.3125,718.5,360.3125,722.5,356.3125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="327.5" x2="724.5" y1="356.3125" y2="356.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="334.5" y="351.2466">post credentials</text><polygon fill="#A80036" points="338.5,381.4453,328.5,385.4453,338.5,389.4453,334.5,385.4453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="332.5" x2="729.5" y1="385.4453" y2="385.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="198" x="344.5" y="380.3794">personalAccount consent page</text><polygon fill="#A80036" points="80.5,410.5781,70.5,414.5781,80.5,418.5781,76.5,414.5781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="74.5" x2="326.5" y1="414.5781" y2="414.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="86.5" y="409.5122">show personalAccount consent page</text><polygon fill="#A80036" points="315.5,439.7109,325.5,443.7109,315.5,447.7109,319.5,443.7109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="69.5" x2="321.5" y1="443.7109" y2="443.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="76.5" y="438.645">personalAccount agrees</text><polygon fill="#A80036" points="718.5,468.8438,728.5,472.8438,718.5,476.8438,722.5,472.8438" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="327.5" x2="724.5" y1="472.8438" y2="472.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="334.5" y="467.7778">post agree</text><polygon fill="#A80036" points="338.5,497.9766,328.5,501.9766,338.5,505.9766,334.5,501.9766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="332.5" x2="729.5" y1="501.9766" y2="501.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="303" x="344.5" y="496.9106">redirect to argos service /oauth2/callback/azure</text><polygon fill="#A80036" points="542.5,527.1094,552.5,531.1094,542.5,535.1094,546.5,531.1094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="327.5" x2="548.5" y1="531.1094" y2="531.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="334.5" y="526.0435">get /oauth2/callback/azure</text><polygon fill="#A80036" points="718.5,556.2422,728.5,560.2422,718.5,564.2422,722.5,560.2422" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="554.5" x2="724.5" y1="560.2422" y2="560.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="561.5" y="555.1763">post /oauth2/v2.0/token</text><polygon fill="#A80036" points="565.5,585.375,555.5,589.375,565.5,593.375,561.5,589.375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="559.5" x2="729.5" y1="589.375" y2="589.375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="571.5" y="584.3091">returns token</text><polygon fill="#A80036" points="1046.5,614.5078,1056.5,618.5078,1046.5,622.5078,1050.5,618.5078" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="554.5" x2="1052.5" y1="618.5078" y2="618.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="561.5" y="613.4419">get userprofile</text><polygon fill="#A80036" points="565.5,643.6406,555.5,647.6406,565.5,651.6406,561.5,647.6406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="559.5" x2="1057.5" y1="647.6406" y2="647.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="571.5" y="642.5747">returns userprofile</text><polygon fill="#A80036" points="1299.5,672.7734,1309.5,676.7734,1299.5,680.7734,1303.5,676.7734" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="554.5" x2="1305.5" y1="676.7734" y2="676.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="244" x="561.5" y="671.7075">store / update personalAccount profile</text><polygon fill="#A80036" points="338.5,701.9063,328.5,705.9063,338.5,709.9063,334.5,705.9063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="332.5" x2="553.5" y1="705.9063" y2="705.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="344.5" y="700.8403">redirect to argos frontend</text><polygon fill="#A80036" points="80.5,731.0391,70.5,735.0391,80.5,739.0391,76.5,735.0391" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="74.5" x2="326.5" y1="735.0391" y2="735.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="86.5" y="729.9731">show argos frontend</text><!--MD5=[ae59e67c4ddeb04486a14c91db4c6e0d]
@startuml

title Argos Server oauth2 authorization flow for azure

actor personalAccount
participant browser
participant "argos service" as argos
participant "external authorization service" as auth
participant "personalAccount profile service (external resource server)" as up
database "database"

personalAccount -> browser: signup / signin

browser -> argos: get oauth2/authorize/azure
argos - -> browser: redirect to authorization service

browser -> auth: get /oauth2/v2.0/authorize
auth - -> browser: login page
browser - -> personalAccount: show login page

personalAccount -> browser: enter credentials
browser -> auth: post credentials
auth - -> browser: personalAccount consent page
browser - -> personalAccount: show personalAccount consent page

personalAccount -> browser: personalAccount agrees
browser -> auth: post agree
auth - -> browser: redirect to argos service /oauth2/callback/azure
browser -> argos: get /oauth2/callback/azure
argos -> auth: post /oauth2/v2.0/token
auth - -> argos: returns token
argos -> up: get userprofile
up - -> argos: returns userprofile
argos -> database: store / update personalAccount profile
argos - -> browser: redirect to argos frontend
browser - -> personalAccount: show argos frontend
@enduml

PlantUML version 1.2020.10(Sun May 17 11:35:57 CEST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_252-8u252-b09-1~18.04-b09
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>