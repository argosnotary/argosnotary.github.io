<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="827px" preserveAspectRatio="none" style="width:1352px;height:827px;background:#FFF5EE;" version="1.1" viewBox="0 0 1352 827" width="1352px" zoomAndPan="magnify"><defs><filter height="300%" id="fc8d3h8mb90e5" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="331" x="511.75" y="814.3779">Argos Server oauth2 authorization flow for azure</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="69" x2="69" y1="86.2969" y2="718.0859"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="327.5" x2="327.5" y1="86.2969" y2="718.0859"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="554.5" x2="554.5" y1="86.2969" y2="718.0859"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="730.5" x2="730.5" y1="86.2969" y2="718.0859"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1058.5" x2="1058.5" y1="86.2969" y2="718.0859"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1311.5" x2="1311.5" y1="86.2969" y2="718.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="117" x="8" y="82.9951">personalAccount</text><ellipse cx="69.5" cy="13" fill="#FEFECE" filter="url(#fc8d3h8mb90e5)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M69.5,21 L69.5,48 M56.5,29 L82.5,29 M69.5,48 L56.5,63 M69.5,48 L82.5,63 " fill="none" filter="url(#fc8d3h8mb90e5)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="117" x="8" y="730.0811">personalAccount</text><ellipse cx="69.5" cy="743.3828" fill="#FEFECE" filter="url(#fc8d3h8mb90e5)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M69.5,751.3828 L69.5,778.3828 M56.5,759.3828 L82.5,759.3828 M69.5,778.3828 L56.5,793.3828 M69.5,778.3828 L82.5,793.3828 " fill="none" filter="url(#fc8d3h8mb90e5)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fc8d3h8mb90e5)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="70" x="290.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="297.5" y="70.9951">browser</text><rect fill="#FEFECE" filter="url(#fc8d3h8mb90e5)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="70" x="290.5" y="717.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="297.5" y="737.0811">browser</text><rect fill="#FEFECE" filter="url(#fc8d3h8mb90e5)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="499.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="506.5" y="70.9951">argos service</text><rect fill="#FEFECE" filter="url(#fc8d3h8mb90e5)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="499.5" y="717.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="506.5" y="737.0811">argos service</text><rect fill="#FEFECE" filter="url(#fc8d3h8mb90e5)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="216" x="620.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="202" x="627.5" y="70.9951">external authorization service</text><rect fill="#FEFECE" filter="url(#fc8d3h8mb90e5)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="216" x="620.5" y="717.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="202" x="627.5" y="737.0811">external authorization service</text><rect fill="#FEFECE" filter="url(#fc8d3h8mb90e5)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="412" x="850.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="398" x="857.5" y="70.9951">personalAccount profile service (external resource server)</text><rect fill="#FEFECE" filter="url(#fc8d3h8mb90e5)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="412" x="850.5" y="717.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="398" x="857.5" y="737.0811">personalAccount profile service (external resource server)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="64" x="1276.5" y="82.9951">database</text><path d="M1293.5,34 C1293.5,24 1311.5,24 1311.5,24 C1311.5,24 1329.5,24 1329.5,34 L1329.5,60 C1329.5,70 1311.5,70 1311.5,70 C1311.5,70 1293.5,70 1293.5,60 L1293.5,34 " fill="#FEFECE" filter="url(#fc8d3h8mb90e5)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1293.5,34 C1293.5,44 1311.5,44 1311.5,44 C1311.5,44 1329.5,44 1329.5,34 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="64" x="1276.5" y="730.0811">database</text><path d="M1293.5,743.3828 C1293.5,733.3828 1311.5,733.3828 1311.5,733.3828 C1311.5,733.3828 1329.5,733.3828 1329.5,743.3828 L1329.5,769.3828 C1329.5,779.3828 1311.5,779.3828 1311.5,779.3828 C1311.5,779.3828 1293.5,779.3828 1293.5,769.3828 L1293.5,743.3828 " fill="#FEFECE" filter="url(#fc8d3h8mb90e5)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1293.5,743.3828 C1293.5,753.3828 1311.5,753.3828 1311.5,753.3828 C1311.5,753.3828 1329.5,753.3828 1329.5,743.3828 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><polygon fill="#A80036" points="315.5,113.4297,325.5,117.4297,315.5,121.4297,319.5,117.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="69.5" x2="321.5" y1="117.4297" y2="117.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="76.5" y="112.3638">signup / signin</text><polygon fill="#A80036" points="542.5,142.5625,552.5,146.5625,542.5,150.5625,546.5,146.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="327.5" x2="548.5" y1="146.5625" y2="146.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="334.5" y="141.4966">get oauth2/authorize/azure</text><polygon fill="#A80036" points="338.5,171.6953,328.5,175.6953,338.5,179.6953,334.5,175.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="332.5" x2="553.5" y1="175.6953" y2="175.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="203" x="344.5" y="170.6294">redirect to authorization service</text><polygon fill="#A80036" points="718.5,200.8281,728.5,204.8281,718.5,208.8281,722.5,204.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="327.5" x2="724.5" y1="204.8281" y2="204.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="334.5" y="199.7622">get /oauth2/v2.0/authorize</text><polygon fill="#A80036" points="338.5,229.9609,328.5,233.9609,338.5,237.9609,334.5,233.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="332.5" x2="729.5" y1="233.9609" y2="233.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="344.5" y="228.895">login page</text><polygon fill="#A80036" points="80.5,259.0938,70.5,263.0938,80.5,267.0938,76.5,263.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="74.5" x2="326.5" y1="263.0938" y2="263.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="86.5" y="258.0278">show login page</text><polygon fill="#A80036" points="315.5,288.2266,325.5,292.2266,315.5,296.2266,319.5,292.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="69.5" x2="321.5" y1="292.2266" y2="292.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="76.5" y="287.1606">enter credentials</text><polygon fill="#A80036" points="718.5,317.3594,728.5,321.3594,718.5,325.3594,722.5,321.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="327.5" x2="724.5" y1="321.3594" y2="321.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="334.5" y="316.2935">post credentials</text><polygon fill="#A80036" points="338.5,346.4922,328.5,350.4922,338.5,354.4922,334.5,350.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="332.5" x2="729.5" y1="350.4922" y2="350.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="198" x="344.5" y="345.4263">personalAccount consent page</text><polygon fill="#A80036" points="80.5,375.625,70.5,379.625,80.5,383.625,76.5,379.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="74.5" x2="326.5" y1="379.625" y2="379.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="86.5" y="374.5591">show personalAccount consent page</text><polygon fill="#A80036" points="315.5,404.7578,325.5,408.7578,315.5,412.7578,319.5,408.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="69.5" x2="321.5" y1="408.7578" y2="408.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="76.5" y="403.6919">personalAccount agrees</text><polygon fill="#A80036" points="718.5,433.8906,728.5,437.8906,718.5,441.8906,722.5,437.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="327.5" x2="724.5" y1="437.8906" y2="437.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="334.5" y="432.8247">post agree</text><polygon fill="#A80036" points="338.5,463.0234,328.5,467.0234,338.5,471.0234,334.5,467.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="332.5" x2="729.5" y1="467.0234" y2="467.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="303" x="344.5" y="461.9575">redirect to argos service /oauth2/callback/azure</text><polygon fill="#A80036" points="542.5,492.1563,552.5,496.1563,542.5,500.1563,546.5,496.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="327.5" x2="548.5" y1="496.1563" y2="496.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="334.5" y="491.0903">get /oauth2/callback/azure</text><polygon fill="#A80036" points="718.5,521.2891,728.5,525.2891,718.5,529.2891,722.5,525.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="554.5" x2="724.5" y1="525.2891" y2="525.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="561.5" y="520.2231">post /oauth2/v2.0/token</text><polygon fill="#A80036" points="565.5,550.4219,555.5,554.4219,565.5,558.4219,561.5,554.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="559.5" x2="729.5" y1="554.4219" y2="554.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="571.5" y="549.356">returns token</text><polygon fill="#A80036" points="1046.5,579.5547,1056.5,583.5547,1046.5,587.5547,1050.5,583.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="554.5" x2="1052.5" y1="583.5547" y2="583.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="561.5" y="578.4888">get userprofile</text><polygon fill="#A80036" points="565.5,608.6875,555.5,612.6875,565.5,616.6875,561.5,612.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="559.5" x2="1057.5" y1="612.6875" y2="612.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="571.5" y="607.6216">returns userprofile</text><polygon fill="#A80036" points="1299.5,637.8203,1309.5,641.8203,1299.5,645.8203,1303.5,641.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="554.5" x2="1305.5" y1="641.8203" y2="641.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="244" x="561.5" y="636.7544">store / update personalAccount profile</text><polygon fill="#A80036" points="338.5,666.9531,328.5,670.9531,338.5,674.9531,334.5,670.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="332.5" x2="553.5" y1="670.9531" y2="670.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="344.5" y="665.8872">redirect to argos frontend</text><polygon fill="#A80036" points="80.5,696.0859,70.5,700.0859,80.5,704.0859,76.5,700.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="74.5" x2="326.5" y1="700.0859" y2="700.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="86.5" y="695.02">show argos frontend</text><!--MD5=[f7715fbc4e564b6eb844ddd338828d9d]
@startuml

caption Argos Server oauth2 authorization flow for azure

skinparam shadowing<<with_shadow>> true
skinparam backgroundColor #SeaShell

actor personalAccount
participant browser
participant "argos service" as argos
participant "external authorization service" as auth
participant "personalAccount profile service (external resource server)" as up
database "database"

personalAccount -> browser: signup / signin

browser -> argos: get oauth2/authorize/azure
argos - -> browser: redirect to authorization service

browser -> auth: get /oauth2/v2.0/authorize
auth - -> browser: login page
browser - -> personalAccount: show login page

personalAccount -> browser: enter credentials
browser -> auth: post credentials
auth - -> browser: personalAccount consent page
browser - -> personalAccount: show personalAccount consent page

personalAccount -> browser: personalAccount agrees
browser -> auth: post agree
auth - -> browser: redirect to argos service /oauth2/callback/azure
browser -> argos: get /oauth2/callback/azure
argos -> auth: post /oauth2/v2.0/token
auth - -> argos: returns token
argos -> up: get userprofile
up - -> argos: returns userprofile
argos -> database: store / update personalAccount profile
argos - -> browser: redirect to argos frontend
browser - -> personalAccount: show argos frontend
@enduml

PlantUML version 1.2020.11(Sat May 30 12:13:43 CEST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>